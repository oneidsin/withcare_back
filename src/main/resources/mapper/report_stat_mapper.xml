<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC   "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.withcare.statistic.dao.ReportStatDAO">

	<!-- 총 신고 수, 전체 or 7일 -->
	<select id="getTotalAndWeeklyCount" resultType="map">
		SELECT
		rep_item_type,
		COUNT(*) AS total_count,
		SUM(CASE WHEN report_at >= DATE_SUB(NOW(), INTERVAL 7 DAY) THEN 1 ELSE 0 END)
		AS weekly_count
		FROM report
		GROUP BY rep_item_type
	</select>

	<!-- 신고 사유 수 세기 -->
	<select id="getReportReason" resultType="map">
		SELECT rep_cate_idx, COUNT(*) AS count
		FROM report
		GROUP BY rep_cate_idx
	</select>

	<!-- 처리 상태 카운트 -->
	<select id="getReportStatus" resultType="map">
		SELECT status, COUNT(*) AS count
		FROM report
		GROUP BY status
	</select>
	
	<!-- 처리 사유 카운트 -->
	<select id="getReportProcessReason" resultType="map">
		SELECT rep_reason, COUNT(*) AS count
		FROM report_history
		GROUP BY rep_reason
	</select>
	
	
</mapper>
   